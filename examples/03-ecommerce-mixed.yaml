# E-Commerce API - Mixed Load
#
# E-commerce API demonstrating different latency patterns and error rates.
# Demonstrates: multiple distributions, varied error rates, realistic latencies

version: "1.0"
metadata:
  name: "ecommerce-mixed"
  description: "E-commerce API with mixed load patterns"
  author: "web-simulant-team"
  created: "2026-02-11T10:00:00Z"

endpoints:
  # Product catalog - fast, cacheable, very reliable
  - id: "get-products"
    method: "GET"
    path: "/api/products"
    latency:
      distribution: "normal"
      params:
        mean_ms: 45
        stddev_ms: 8
    response:
      status: 200
      headers:
        Content-Type: "application/json"
        Cache-Control: "max-age=300"
        X-Total-Count: "42"
      body: |
        {
          "products": [
            {
              "id": "p1",
              "name": "Wireless Mouse",
              "price": 29.99,
              "category": "Electronics",
              "in_stock": true
            },
            {
              "id": "p2",
              "name": "Mechanical Keyboard",
              "price": 89.99,
              "category": "Electronics",
              "in_stock": true
            },
            {
              "id": "p3",
              "name": "USB-C Cable",
              "price": 12.99,
              "category": "Accessories",
              "in_stock": false
            }
          ],
          "page": 1,
          "total_pages": 14
        }
    error_profile:
      rate: 0.0005
      codes: [500]
      body: '{"error": "Product service unavailable"}'

  # Search - variable latency (exponential distribution)
  - id: "search-products"
    method: "GET"
    path: "/api/search"
    latency:
      distribution: "exponential"
      params:
        rate: 0.015
    response:
      status: 200
      headers:
        Content-Type: "application/json"
      body: |
        {
          "query": "keyboard",
          "results": [
            {"id": "p2", "name": "Mechanical Keyboard", "relevance": 0.95},
            {"id": "p8", "name": "Gaming Keyboard", "relevance": 0.87}
          ],
          "total": 2
        }
    error_profile:
      rate: 0.002
      codes: [503]
      body: '{"error": "Search index temporarily unavailable"}'

  # Shopping cart - moderate speed, moderate reliability
  - id: "get-cart"
    method: "GET"
    path: "/api/cart"
    latency:
      distribution: "normal"
      params:
        mean_ms: 80
        stddev_ms: 15
    response:
      status: 200
      headers:
        Content-Type: "application/json"
      body: |
        {
          "cart_id": "cart-abc123",
          "items": [
            {
              "product_id": "p1",
              "quantity": 2,
              "unit_price": 29.99,
              "subtotal": 59.98
            }
          ],
          "total": 59.98,
          "currency": "USD"
        }
    error_profile:
      rate: 0.01
      codes: [500, 503]
      body: '{"error": "Cart service error"}'

  # Add to cart - slower write, session management
  - id: "add-to-cart"
    method: "POST"
    path: "/api/cart/items"
    latency:
      distribution: "uniform"
      params:
        min_ms: 80
        max_ms: 150
    response:
      status: 201
      headers:
        Content-Type: "application/json"
      body: |
        {
          "cart_id": "cart-abc123",
          "item_added": {
            "product_id": "p1",
            "quantity": 1
          },
          "total_items": 3
        }
    error_profile:
      rate: 0.015
      codes: [400, 409, 500]
      body: '{"error": "Failed to add item to cart", "code": "CART_ERROR"}'

  # Checkout - longest operation, highest error rate
  - id: "checkout"
    method: "POST"
    path: "/api/checkout"
    latency:
      distribution: "normal"
      params:
        mean_ms: 350
        stddev_ms: 80
    response:
      status: 200
      headers:
        Content-Type: "application/json"
        X-Transaction-Id: "txn-xyz789"
      body: |
        {
          "order_id": "order-123456",
          "status": "confirmed",
          "total": 59.98,
          "estimated_delivery": "2026-02-15",
          "payment_method": "card_ending_4242"
        }
    error_profile:
      rate: 0.05
      codes: [400, 402, 409, 500, 503]
      body: '{"error": "Checkout failed", "code": "CHECKOUT_ERROR", "retry_allowed": true}'

  # Order status - fast read, very reliable
  - id: "get-order"
    method: "GET"
    path: "/api/orders/latest"
    latency:
      distribution: "fixed"
      params:
        delay_ms: 25
    response:
      status: 200
      headers:
        Content-Type: "application/json"
      body: |
        {
          "order_id": "order-123456",
          "status": "shipped",
          "tracking_number": "TRACK123456789",
          "items": 2,
          "total": 59.98
        }
    error_profile:
      rate: 0.001
      codes: [404, 500]
      body: '{"error": "Order not found"}'

workflows: []
